{% load static i18n l10n sekizai_tags %}

{% addtoblock "js" %}<script src="https://js.stripe.com/v2/" type="text/javascript"></script>{% endaddtoblock %}
{% addtoblock "js" %}<script src="{% static 'shop/js/angular-stripe.js' %}" type="text/javascript"></script>{% endaddtoblock %}

{% addtoblock "js" %}<script src="{% static 'shop/js/stripe.js' %}" type="text/javascript"></script>{% endaddtoblock %}
{% add_data "ng-requires" "django.shop.stripe" %}
{% addtoblock "ng-config" %}['stripeProvider', function(stripeProvider) { stripeProvider.setPublishableKey('{{ SHOP_STRIPE_PUBKEY }}'); }]{% endaddtoblock %}

<div class="card">
{% block card_heading %}
	<div class="card-header">
		<h5 class="card-title my-0">
			{% trans "Payment" %}
			<img class="pull-right my-auto" src="{% static 'shop/icons/stripe-solid-dark.png' %}" srcset="{% static 'shop/icons/stripe-solid-dark.png' %} 1x, {% static 'shop/icons/stripe-solid-dark@2x.png' %} 2x, {% static 'shop/icons/stripe-solid-dark@3x.png' %} 3x" width="119" height="26" style="margin-top: -4px;">
		</h5>
	</div>
{% endblock card_heading %}
	<div class="card-body">
		<form role="form" name="stripe_card_form" stripe-card-form novalidate{% if SHOP_STRIPE_PREFILL %} ng-init="payment={card: {name: 'John Doe', number: '4242 4242 4242 4242', exp_month: '01', exp_year: '2020', cvc: '123'}}"{% endif %}>
			<div class="form-row">
				<div class="col form-group">
					<div class="alert alert-success" ng-show="stripeSuccessMessage" ng-cloak>
						{% verbatim %}{{ stripeSuccessMessage }}{% endverbatim %}
					</div>
					<div class="alert alert-danger" ng-show="stripeErrorMessage" ng-cloak>
						{% verbatim %}{{ stripeErrorMessage }}{% endverbatim %}
					</div>
					<label for="card_holder">{% trans "Card Holder" %}</label>
					<div class="input-group">
						<input id="id_card[holder]" type="text" class="form-control" name="card[holder]" placeholder="Card holder name" ng-model="payment.card.name" ng-change="resetStripeToken('card[holder]')" ng-required />
						<div class="input-group-append">
							<span class="input-group-text"><i class="fa fa-user"></i></span>
						</div>
					</div>
				</div>
			</div>
			<div class="form-row">
				<div class="col form-group">
					<label for="card_number">{% trans "Creditcard Number" %}</label>
					<div class="input-group">
						<input id="id_card[number]" type="text" class="form-control" name="card[number]" placeholder="Valid Card Number" ng-model="payment.card.number" ng-change="resetStripeToken('card[number]')"  ng-required />
						<div class="input-group-append">
							<div class="input-group-text">
								<i class="fa fa fa-cc-visa mr-1"></i>
								<i class="fa fa fa-cc-mastercard"></i>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="form-row">
				<div class="col-6 form-group">
					<label>{% trans "Expiration Date" %}</label>
					<div class="w-100 d-flex">
						<select id="id_card[exp_month]" class="form-control w-50 d-inline-flex mr-1" name="card[exp_month]" ng-model="payment.card.exp_month" ng-change="resetStripeToken('card[exp_month]')"  ng-required>
							<option value="" selected="selected" disabled="disabled">{% trans "Month" %}</option>
						{% for mm, month_name in payment_modifiers.month_range %}
							<option value="{{ mm }}">{{ mm }} / {{ month_name }}</option>
						{% endfor %}
						</select>
						<select id="id_card[exp_year]" class="form-control w-50 d-inline-flex ml-1" name="card[exp_year]" ng-model="payment.card.exp_year" ng-change="resetStripeToken('card[exp_year]')" ng-required>
							<option value="" selected="selected" disabled="disabled">{% trans "Year" %}</option>
						{% for year in payment_modifiers.years_range %}
							<option value="{{ year|unlocalize }}">{{ year|unlocalize }}</option>
						{% endfor %}
						</select>
					</div>
				</div>
				<div class="col form-group offset-md-3">
					<label for="cvc">{% trans "Security Code" %}</label>
					<div class="input-group">
						<input id="id_card[cvc]" type="password" class="form-control" name="card[cvc]" placeholder="CVC" ng-model="payment.card.cvc"  ng-change="resetStripeToken('card[cvc]')"  ng-required />
						<div class="input-group-append">
							<div class="input-group-text"><i class="fa fa-credit-card"></i></div>
						</div>
					</div>
				</div>
			</div>
		</form>
	</div>
</div>
